<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>42导出 | funtim的博客</title><meta name="author" content="funtim41@gmail.com"><meta name="copyright" content="funtim41@gmail.com"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="导出Revit API允许将Revit文档或其中的一部分导出为各种格式，以便与其他软件一起使用。Document类具有重载的Export（）方法，该方法将使用Revit中的内置导出器（如果可用）启动文档的导出。对于更高级的需求，可以使用Revit附加模块自定义某些类型的导出，例如导出到IFC和导出到Navisworks。(Note，Navisworks导出仅作为附加模块导出器提供）。 下表概述了D">
<meta property="og:type" content="article">
<meta property="og:title" content="42导出">
<meta property="og:url" content="https://funtim41.github.io/2024/12/30/%E4%BA%8C%E5%BC%80%E6%8C%87%E5%8D%97/42%E5%AF%BC%E5%87%BA/">
<meta property="og:site_name" content="funtim的博客">
<meta property="og:description" content="导出Revit API允许将Revit文档或其中的一部分导出为各种格式，以便与其他软件一起使用。Document类具有重载的Export（）方法，该方法将使用Revit中的内置导出器（如果可用）启动文档的导出。对于更高级的需求，可以使用Revit附加模块自定义某些类型的导出，例如导出到IFC和导出到Navisworks。(Note，Navisworks导出仅作为附加模块导出器提供）。 下表概述了D">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://funtim41.github.io/images/4stars.png">
<meta property="article:published_time" content="2024-12-30T08:07:29.000Z">
<meta property="article:modified_time" content="2024-12-30T08:19:39.643Z">
<meta property="article:author" content="funtim41@gmail.com">
<meta property="article:tag" content="Revit">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://funtim41.github.io/images/4stars.png"><link rel="shortcut icon" href="/images/OIP.jfif"><link rel="canonical" href="https://funtim41.github.io/2024/12/30/%E4%BA%8C%E5%BC%80%E6%8C%87%E5%8D%97/42%E5%AF%BC%E5%87%BA/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: funtim41@gmail.com","link":"链接: ","source":"来源: funtim的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '42导出',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/bar.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background: Color(#995a82);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/4stars.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Timeline</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/Links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/images/topback.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/images/OIP.jfif" alt="Logo"><span class="site-name">funtim的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">42导出</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Timeline</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/Links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">42导出</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-30T08:07:29.000Z" title="发表于 2024-12-30 16:07:29">2024-12-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-30T08:19:39.643Z" title="更新于 2024-12-30 16:19:39">2024-12-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Revit%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E6%8C%87%E5%8D%97/">Revit二次开发人员指南</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h1><p>Revit API允许将Revit文档或其中的一部分导出为各种格式，以便与其他软件一起使用。Document类具有重载的Export（）方法，该方法将使用Revit中的内置导出器（如果可用）启动文档的导出。对于更高级的需求，可以使用Revit附加模块自定义某些类型的导出，例如导出到IFC和导出到Navisworks。(Note，Navisworks导出仅作为附加模块导出器提供）。</p>
<p>下表概述了Document.Export（）方法重载。</p>
<p>表：Document.Export（）方法</p>
<table>
<thead>
<tr>
<th>格式</th>
<th><strong>Export() parameters</strong></th>
<th><strong>Comments</strong></th>
</tr>
</thead>
<tbody><tr>
<td>gbXML</td>
<td>String, String, MassGBXMLExportOptions</td>
<td>从体量模型文档导出gbXML文件</td>
</tr>
<tr>
<td>gbXML</td>
<td>String, String, GBXMLExportOptions</td>
<td>以Green-Building XML格式导出文档。如果将EnergyDataSettings设置为使用概念模型，则无法使用此函数：请改用上述方法。</td>
</tr>
<tr>
<td>IFC</td>
<td>String, String, IFCExportOptions</td>
<td>将文档导出为行业标准类（IFC）格式。</td>
</tr>
<tr>
<td>NWC</td>
<td>String, String, NavisworksExportOptions</td>
<td>将Revit项目导出为Navisworks .nwc格式。请注意，要使用此功能，必须在Revit任务中注册兼容的Navisworks导出器附加模块。</td>
</tr>
<tr>
<td>DWF</td>
<td>String, String, ViewSet, DWFExportOptions</td>
<td>以XML格式导出当前视图或选定的视图。</td>
</tr>
<tr>
<td>DWFX</td>
<td>String, String, ViewSet, DWFXExportOptions</td>
<td>以DWFX格式导出当前视图或选定的视图。</td>
</tr>
<tr>
<td>FBX</td>
<td>String, String, ViewSet, FBXExportOptions</td>
<td>以3D-Studio Max（FBX）格式导出文档。</td>
</tr>
<tr>
<td>DGN</td>
<td>String, String, ICollection(ElementId), DGNExportOptions</td>
<td>以DGN格式导出选定的视图。</td>
</tr>
<tr>
<td>DWG</td>
<td>String, String, ICollection(ElementId), DWGExportOptions</td>
<td>以DWG格式导出选定的视图。</td>
</tr>
<tr>
<td>DXF</td>
<td>String, String, ICollection(ElementId), DXFExportOptions</td>
<td>以XML格式导出选定的视图。</td>
</tr>
<tr>
<td>SAT</td>
<td>String, String, ICollection(ElementId), SATExportOptions</td>
<td>以SAT格式导出当前视图或选定的视图。</td>
</tr>
<tr>
<td>ADSK</td>
<td>String, String, View3D, ViewPlan, BuildingSiteExportOptions</td>
<td>以Autodesk Civil 3D ®格式导出文档。</td>
</tr>
</tbody></table>
<p><strong>导出为gbXML</strong></p>
<p>有两种方法可以导出为绿色建筑XML格式。最后一个参数为MassGBXMLExportOptions的参数仅适用于包含一个或多个概念体量族实例的项目。要传递到此方法中的MassGBXMLExportOptions对象可以仅使用要在导出的gbXML中分析的体量分区的ID来构造，也可以使用体量分区ID和要在导出的gbXML中用作着色表面的体量的ID来构造。使用体量时，它们不能有体量楼层或体量分区，以免在gbXML输出中出现重复的曲面信息。</p>
<p>用于其他gbXML导出选项的GBXMLExportOptions对象没有要指定的设置。它使用所有默认设置。注意，该方法不生成能量模型。在调用此导出之前，主能量模型必须已存储在文档中。</p>
<p><strong>导出到IFC</strong></p>
<p>使用IFC选项调用Document.Export（）将使用默认的Revit IFC导出实现或自定义IFC导出（如果已在Revit的当前任务中注册）。在这两种情况下，IFCExportOptions类都用于设置导出选项，例如是否导出Revit当前支持的IFC标准数量，或是否允许按标高分割多层墙和柱。</p>
<p><strong>导出到Navisworks</strong></p>
<p>Navisworks的Export方法需要在当前Revit任务中注册兼容的Navisworks导出器附加模块。如果没有注册兼容的导出器，则该方法将引发异常。使用OptionalFunctionalityUtils.IsNavisworksExporterAvailable（）方法确定Navisworks导出程序是否已注册。</p>
<p>NavisworksExportOptions对象可用于设置导出到Navisworks的许多导出设置，例如是否将文件划分为级别以及是否导出房间几何图形。此外，NavisworksExportOptions.ExportScope属性指定导出范围。默认值为“模型”。其他选项包括View和SelectedElements。当设置为“视图”时，NavisworksExportOptions。ViewId属性应相应设置。此属性仅在导出范围设置为View时使用。当设置为SelectedElements时，NavisworksExportOptions。应该使用要导出的元素的id调用SetSelectedElementIds（）方法。</p>
<p><strong>导出到DXF和DWFX</strong></p>
<p>可以使用相应的Document.Export（）重载导出DWFX和DWFX文件。这两个方法都有一个ViewSet参数，表示要导出的视图。ViewSet中的所有视图都必须是可打印的，才能使导出成功。这可以使用每个视图的View.CanBePrinted属性进行检查。最后一个参数是DWFExportOptions或DWFXExportOptions。DWFXExportOptions派生自DWFExportOptions，并具有所有相同的导出设置。选项包括是否导出裁剪框、图像质量是否将纹理导出为3D打印文件以及纸张格式。</p>
<p>代码区域：Export DWF</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ExportViewToDWF</span>(<span class="params">Document document, View view, <span class="built_in">string</span> pathname</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    DWFExportOptions dwfOptions = <span class="keyword">new</span> DWFExportOptions();</span><br><span class="line">    <span class="comment">// export with crop box and area and room geometry</span></span><br><span class="line">    dwfOptions.CropBoxVisible = <span class="literal">true</span>;</span><br><span class="line">    dwfOptions.ExportingAreas = <span class="literal">true</span>;</span><br><span class="line">    dwfOptions.ExportTexture = <span class="literal">false</span>;</span><br><span class="line">    ViewSet views = <span class="keyword">new</span> ViewSet();</span><br><span class="line">    views.Insert(view);</span><br><span class="line">    <span class="keyword">return</span> (document.Export(Path.GetDirectoryName(pathname),</span><br><span class="line">        Path.GetFileNameWithoutExtension(pathname), views, dwfOptions));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>导出到3D-Studio Max</strong></p>
<p>FBX导出要求存在某些可选模块，这些模块可能不是已安装的Revit的一部分，因此OptionalFunctionalityUtils。IsFBXExportAvailable（）方法报告FBX导出功能是否可用。用于导出到3D-Studio Max的Export（）方法有一个ViewSet参数，表示要导出的视图集。仅允许3D视图。FBXExportOptions参数可用于指定是否在不带边界边的情况下导出、是否使用详细级别以及在视图导出失败时是否应停止导出过程。</p>
<p><strong>导出为CAD图形</strong></p>
<p>输出为DGN、DWG和DXF格式文件具有类似的输出方法和选项。</p>
<p>DGN、DWG和DXF导出都需要存在某些可选模块，这些模块可能不是已安装的Revit版本的一部分，因此OptionalFunctionalityUtils类作为相应的方法来报告这些类型的导出功能是否可用。</p>
<p>用于导出为DGN、DWG和DWG格式的Export（）方法都有一个参数，表示要导出的视图（作为视图的ElementId的ICollection）。必须至少存在一个有效视图，并且该视图必须是可打印的，导出才能成功。这可以使用每个视图的View.CanBePrinted属性进行检查。</p>
<p>每种格式的导出选项都派生自BaseExportOptions，因此有许多通用的导出设置，例如颜色模式或是否隐藏范围框。BaseExportOptions还有一个名为GetPredefinedSetupNames（）的静态方法，它将返回文档的任何预定义设置。然后，可以将预定义设置的名称传递到静态方法GetPredefinedOptions（）中，该方法可从相应的选项类获得：DWGExportOptions、DGNExportOptions或DXFExportOptions。DWG和DWG文件的导出选项具有更多的共同选项，因为它们共享基类ACADExportOptions。</p>
<p>以下示例使用第一个预定义设置名称和预定义选项将活动视图（如果可以打印）导出到DGN文件，而不进行任何更改。</p>
<p>代码区域：出口DGN</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ExportDGN</span>(<span class="params">Document document, View view</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">bool</span> exported = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// Get predefined setups and export the first one</span></span><br><span class="line">    IList setupNames = BaseExportOptions.GetPredefinedSetupNames(document);</span><br><span class="line">    <span class="keyword">if</span> (setupNames.Count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Get predefined options for first predefined setup</span></span><br><span class="line">        DGNExportOptions dgnOptions = DGNExportOptions.GetPredefinedOptions(document, setupNames[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// export the active view if it is printable</span></span><br><span class="line">        <span class="keyword">if</span> (document.ActiveView.CanBePrinted == <span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ICollection views = <span class="keyword">new</span> List();</span><br><span class="line">            views.Add(view.Id);</span><br><span class="line">            exported = document.Export(Path.GetDirectoryName(document.PathName),</span><br><span class="line">                Path.GetFileNameWithoutExtension(document.PathName), views, dgnOptions);</span><br><span class="line">        &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> exported;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于这些文件类型，可以指定或修改各种映射设置，例如通过创建相应的表并将其传递到BaseExportOptions类的相应方法来指定或修改图层映射或文本字体映射。对于图层映射，您也可以将字符串值传递给预定义图层映射样式的BaseExportOptions.LayerMapping或图层映射文件的文件名。有关创建或修改导出表的详细信息，请参阅导出表主题。</p>
<p><strong>导出到SAT</strong></p>
<p>SAT的Export方法有一个表示要导出的视图的参数（作为视图的ElementId的ICollection）。必须至少存在一个有效视图，并且该视图必须是可打印的，导出才能成功。这可以使用每个视图的View.CanBePrinted属性进行检查。SATExportOptions对象没有要指定的设置。它使用所有默认设置。</p>
<p>导出到 Civil Engineering Design程序</p>
<p>最后一个Export（）方法以土木工程设计应用程序的格式导出文档的3D视图。该方法的一个参数是指定总面积平面的视图平面。视图平面上的所有区域都将被导出，并且它必须是“总建筑”面积平面。若要检查其面积方案是否为Gross Building，请使用AreaScheme.GrossBuildingArea属性。BuildingSiteExportOptions对象允许自定义设置值，如总面积或总占用率。</p>
<p>本节中的页面</p>
<ul>
<li>导出表</li>
<li>IFC导出</li>
<li>自定义导出</li>
</ul>
<h2 id="导出表"><a href="#导出表" class="headerlink" title="导出表"></a>导出表</h2><p>下表中列出的类公开了对用于在导出为各种格式（如DWG和DGN）时进行映射的表的读写访问权限。每个类都包含（key，info）对映射数据。</p>
<table>
<thead>
<tr>
<th><strong>Class</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ExportLayerTable</td>
<td>表示支持将各种图层特性（类别、名称、颜色名称）映射到目标导出格式中的图层名称的表。</td>
</tr>
<tr>
<td>ExportLinetypeTable</td>
<td>表示一个表，该表支持线型名称的映射（采用目标导出格式）。</td>
</tr>
<tr>
<td>ExportPatternTable</td>
<td>表示支持将FillPattern名称和id映射到目标导出格式中的FillPattern名称的表。</td>
</tr>
<tr>
<td>ExportFontTable</td>
<td>表示支持目标导出格式的字体名称映射的表。</td>
</tr>
<tr>
<td>ExportLineweightTable</td>
<td>表示支持目标导出格式的线宽名称映射的表。</td>
</tr>
</tbody></table>
<p>这些表中的大多数都可以通过BaseExportOptions类（DGN、DWG和DWG格式选项的基类）获得。ExportLineweightTable可从DGNExportOptions类中获得。每个表都有一个对应的Get和Set方法。要修改映射，请获取相应的表，进行更改，然后将其设置回选项类。 以下示例在导出DWG文件之前修改ExportLayerTable。</p>
<p>代码区域：导出具有修改的ExportLayerTable的DWG</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ExportDWGModifyLayerTable</span>(<span class="params">Document document, View view</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">bool</span> exported = <span class="literal">false</span>;</span><br><span class="line">    IList setupNames = BaseExportOptions.GetPredefinedSetupNames(document);</span><br><span class="line">    <span class="keyword">if</span> (setupNames.Count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Get the export options for the first predefined setup</span></span><br><span class="line">        DWGExportOptions dwgOptions = DWGExportOptions.GetPredefinedOptions(document, setupNames[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get the export layer table</span></span><br><span class="line">        ExportLayerTable layerTable = dwgOptions.GetExportLayerTable();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Find the first mapping for the Ceilings category</span></span><br><span class="line">        <span class="built_in">string</span> category = <span class="string">&quot;Ceilings&quot;</span>;</span><br><span class="line">        ExportLayerKey targetKey = layerTable.GetKeys().First(layerKey =&gt; layerKey.CategoryName == category);</span><br><span class="line">        ExportLayerInfo targetInfo = layerTable[targetKey];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// change the color name and cut color number for this mapping</span></span><br><span class="line">        targetInfo.ColorName = <span class="string">&quot;31&quot;</span>;</span><br><span class="line">        targetInfo.CutColorNumber = <span class="number">31</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set the change back to the map</span></span><br><span class="line">        layerTable[targetKey] = targetInfo;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set the modified table back to the options</span></span><br><span class="line">        dwgOptions.SetExportLayerTable(layerTable);</span><br><span class="line"></span><br><span class="line">        ICollection views = <span class="keyword">new</span> List();</span><br><span class="line">        views.Add(view.Id);</span><br><span class="line"></span><br><span class="line">        exported = document.Export(Path.GetDirectoryName(document.PathName),</span><br><span class="line">            Path.GetFileNameWithoutExtension(document.PathName), views, dwgOptions);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> exported;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="IFC导出"><a href="#IFC导出" class="headerlink" title="IFC导出"></a>IFC导出</h2><p><strong>自定义IFC导出</strong></p>
<p>Revit API允许自定义应用程序覆盖IFC导出过程的默认实现。</p>
<p>在Revit中注册IExporterIFC对象后，当用户从UI和API方法Document.Export（String，String，IFCExportOptions）调用到IFC的导出时，都将使用该对象。在这两种情况下，如果未注册自定义IFC导出器，则将使用IFC导出的默认Revit实现。</p>
<p>从API调用IFC导出时，IFCExportOptions可用于设置用户从“导出IFC”对话框中可用的相同导出选项。</p>
<p><strong>IExporterIFC</strong></p>
<p>接口IExporterIFC只有一个要实现的方法ExportIFC（）。此方法由Revit调用以执行到IFC的导出。ExporterIFC对象作为其参数之一传递给此方法。ExporterIFC是Revit提供的用于实现IFC导出的主类。它包含有关用户为导出操作选择的选项的信息，以及用于访问正确实现导出所需的特定数据类型的成员的信息。</p>
<p>Autodesk.Revit.DB.IFC命名空间包含许多与IFC相关的API类，IFC导出过程的自定义实现可以使用这些类。有关自定义IFC导出应用程序的完整示例，请参见<a target="_blank" rel="noopener" href="http://sourceforge.net/projects/ifcexporter/%E4%B8%8A%E7%9A%84%E5%BC%80%E6%94%BE%E6%BA%90%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%E3%80%82">http://sourceforge.net/projects/ifcexporter/上的开放源代码示例。</a></p>
<h2 id="自定义导出"><a href="#自定义导出" class="headerlink" title="自定义导出"></a>自定义导出</h2><p>使用自定义导出过程从Revit文档导出三维视图。</p>
<p>Revit API提供了一组类，可以通过自定义导出上下文导出三维视图。这些类提供对渲染输出管道的访问，Revit通过该管道将模型的图形三维表示发送到输出设备。在自定义导出的情况下，“设备”由上下文对象表示，该上下文对象可以是任何类型的设备。一个文件将是最常见的情况。</p>
<p>自定义导出器的实现提供上下文并调用模型的渲染，然后Revit开始处理模型并通过上下文的方法发送图形数据。数据描述的模型与渲染模型时在Revit中显示的完全一样。数据包括所有几何和材料属性。</p>
<p><strong>CustomExporter类</strong></p>
<p>CustomExporter类允许通过自定义导出上下文导出3D视图。此类的Export（）方法触发Revit中的标准渲染过程，但不是在屏幕或打印机上显示结果，而是通过处理几何和非几何信息的给定自定义上下文传递输出。</p>
<p><strong>IExportContext</strong></p>
<p>IExportContext类的实例作为CustomExporter构造函数的参数传递。然后在导出模型的实体时调用该接口的方法。</p>
<p>虽然可以创建从IExportContext类派生的类，但最好使用其派生类之一：IPhotoRenderContext或IModelExportContext。使用IPhotoRenderContext执行自定义导出时，Revit将遍历模型并输出模型的几何图形，就像处理通过UI调用的渲染命令一样。只有具有实际几何图形且适合在渲染视图中显示的图元才会被处理和输出。</p>
<p>IModelExportContext应用于处理视图中的图元，处理方式与Revit在三维视图中处理图元的方式相同。此上下文支持其他元素，包括三维视图中显示的模型曲线和文本。</p>
<p><strong>RenderNode类</strong></p>
<p>RenderNode是模型导出过程中所有输出节点的基类。节点可以是几何节点（如元素或灯光），也可以是非几何节点（如材质）。某些类型的节点是包含其他渲染节点的容器节点。</p>
<p><strong>CameraInfo</strong></p>
<p>CameraInfo类描述有关3D视图到渲染图像的投影映射的信息。这个类的实例可以通过ViewNode的属性获得。如果为空，则应假定为正交视图。</p>
<h2 id="注：翻译自Revit-API-Developers-Guide"><a href="#注：翻译自Revit-API-Developers-Guide" class="headerlink" title="注：翻译自Revit API Developers Guide"></a><em><strong>注：</strong></em>翻译自<a target="_blank" rel="noopener" href="https://help.autodesk.com/view/RVT/2018/ENU/?guid=Revit_API_Revit_API_Developers_Guide_html">Revit API Developers Guide</a></h2></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Revit/">Revit</a></div><div class="post-share"><div class="social-share" data-image="/images/4stars.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/01/08/%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE/Hexo+Butterfly%E4%BB%A3%E7%A0%81%E5%9D%97%E6%B0%B4%E5%B9%B3%E6%BB%9A%E5%8A%A8%E6%9D%A1/" title="Hexo+Butterfly代码块水平滚动条"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hexo+Butterfly代码块水平滚动条</div></div><div class="info-2"><div class="info-item-1">Hexo+Butterfly代码块水平滚动条虽然Butterfly主题有滚动条，但是极其不明显。文档里也没找到配置方式，索性自己整一个。   blog\themes\butterfly\source下新建一个scrollbar.css文件，写入以下内容。 12345678910111213/* 滚动条 */::-webkit-scrollbar-thumb &#123;    background-color: #ebdccf !important;      border-radius: 3em;&#125;::-webkit-scrollbar-track &#123;    background-color: #292d3e;    border-radius: 3em;&#125;::-webkit-scrollbar &#123;    width: 5px;    height: 8px;&#125;  在_config.butterfly.yml找到 12345inject:   head:             # - &lt;link...</div></div></div></a><a class="pagination-related" href="/2024/12/30/%E4%BA%8C%E5%BC%80%E6%8C%87%E5%8D%97/41%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6/" title="41链接文件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">41链接文件</div></div><div class="info-2"><div class="info-item-1">链接文件Revit API可以确定Revit中的哪些图元是对外部文件（“链接文件”）的引用，并可以对Revit加载外部文件的方式进行一些修改。 包含ExternalFileReference的元素是引用基.rvt文件之外的某个文件的元素。示例包括Revit链接、CAD链接、存储注释记号文件位置的图元和渲染贴花。IsExternalFileReference（）返回元素是否表示外部文件。GetExternalFileReference（）返回给定Element的ExternalFileReference，其中包含与该元素引用的外部文件有关的信息。 以下类与Revit API中的链接文件关联：  ExternalFileReference - 非Element类，包含Revit项目引用的单个外部文件的路径和类型信息。 ExternalFileUtils -一个实用程序类，允许用户查找所有外部文件引用，从元素中获取外部文件引用，或者告诉元素是否是外部文件引用。 RevitLinkType -表示链接到Revit项目的Revit文件的图元。 ModelPath -...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/11/18/RevitApi%E5%90%88%E9%9B%86/Autodesk.RevitAddIns%20Namespace/" title="Autodesk.RevitAddIns Namespace"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-18</div><div class="info-item-2">Autodesk.RevitAddIns Namespace</div></div><div class="info-2"><div class="info-item-1">Autodesk.RevitAddIns Namespace类AddInManifestUtility此静态类提供从 Revit .addin 文件中读取清单内容的访问。   方法  GetRevitAddInBundleManifests  GetRevitAddInManifest  GetRevitAddInManifests     RevitAddInApplication表示 Revit 外部应用程序。  构造器  RevitAddInApplication 创建 external application info 类的新实例。    属性  Name  Application name    继承关系  System.Object  Autodesk.RevitAddIns.RevitAddInItem  Autodesk.RevitAddIns.RevitAddInApplication    RevitAddInCommand表示 Revit 外部命令。  构造器  RevitAddInCommand 创建 Add-In Command info...</div></div></div></a><a class="pagination-related" href="/2024/11/18/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20CurveArray/" title="Autodesk.Revit.DB CurveArray"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-18</div><div class="info-item-2">Autodesk.Revit.DB CurveArray</div></div><div class="info-2"><div class="info-item-1">Autodesk.Revit.DB CurveArray可以包含曲线的数组。 语法1public class CurveArray : APIObject, IEnumerable  继承层次结构System Object ​	Autodesk.Revit.DB APIObject ​		Autodesk.Revit.DB CurveArray 另见CurveArray Members Autodesk.Revit.DB Namespace 构造函数CurveArray创建CurveArray类的新实例 方法Append将曲线添加到数组的末尾。 Clear从数组中删除每条曲线，使其为空。 ForwardIterator将一个向前移动的迭代器添加到数组中。 GetEnumerator将一个向前移动的迭代器添加到数组中。 Insert将指定的曲线插入数组。 ReverseIterator返回一个向后移动的迭代器到数组。 属性IsEmpty测试数组是否为空。 Item获取或设置数组中指定索引处的曲线。 Size返回数组中的曲线数。 注：翻译自Revit Api docs 2018</div></div></div></a><a class="pagination-related" href="/2024/12/10/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20Opening/" title="Autodesk.Revit.DB Opening"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-10</div><div class="info-item-2">Autodesk.Revit.DB Opening</div></div><div class="info-2"><div class="info-item-1">Autodesk.Revit.DB OpeningAutodesk Revit项目或族文档中的洞口。 语法1public class Opening : Element  附注该对象表示各种不同类型的洞口：  墙中由修订项目中的两个边界点创建的矩形洞口。 由应用于屋顶、楼板、天花板、梁、支撑或柱的一组曲线创建的洞口。 一个垂直的竖井开口延伸到一个或多个水平。 在族文档中的墙或天花板上创建的简单洞口。  根据打开的类型，此类的某些属性将不可用。 这个对象派生自Element基对象，并且支持该对象的所有方法，例如检索该对象的参数的能力。此对象还支持访问结构分析模型，但此功能仅适用于Autodesk Revit Structure。 示例123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051### private void Getinfo_Opening(Opening opening)&#123;    string message =...</div></div></div></a><a class="pagination-related" href="/2024/12/10/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20ReferenceIntersector/" title="Autodesk.Revit.DB ReferenceIntersector"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-10</div><div class="info-item-2">Autodesk.Revit.DB ReferenceIntersector</div></div><div class="info-2"><div class="info-item-1">Autodesk.Revit.DB ReferenceIntersector用于查找和返回与从原点和方向创建的射线相交的元素的类。 语法1public class ReferenceIntersector : IDisposable    附注可以构造此类的实例，以返回与由原点和方向创建的射线，或者基于过滤和标志返回元素的子集。 调用者可以选择使用ElementFilter过滤结果，或者通过应用特定的可接受的元素。 调用方还可以指定要返回的对象的类型， 整个元素、几何体对象或其组合。 在所有情况下，要求调用者提供 用于评估的3D视图;输入视图上的视图和可见性设置将确定 返回特定元素（例如，此工具永远不会返回隐藏元素、 和几何图形位于视图剖面框之外的元素）。 该类配置为可以构建单个实例，并用于对多个不同光线进行多次评估。在同一个 ReferenceIntersector 上的调用之间，评估结果不会被保留。 该类还提供了一个选项，用于返回在Revit链接中遇到的图元结果。 当设置 FindReferencesInRevitLinks 标志...</div></div></div></a><a class="pagination-related" href="/2024/12/19/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.UI.Selection%20Namespace/" title="Autodesk.Revit.UI.Selection"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-19</div><div class="info-item-2">Autodesk.Revit.UI.Selection</div></div><div class="info-2"><div class="info-item-1">Autodesk.Revit.UI.SelectionClassesPickedBox包含两个 XYZ 点的类，表示屏幕上的选取框。  Properties  Max 最大坐标数（拾取框的右上角）。  Min 最小坐标（拾取框的左下角）。     SelectableInViewFilter一个过滤器，用于传递在给定视图中可选的元素。  Constructors  SelectableInViewFilter  (Document, ElementId) 构造 SelectableInViewFilter 的新实例。  SelectableInViewFilter (Document, ElementId, Boolean) 构造 SelectableInViewFilter 的新实例，并可选择传递所有不可选择的元素。    Methods  PassesFilter(Element) 将筛选器应用于给定元素。  PassesFilter(Document,...</div></div></div></a><a class="pagination-related" href="/2024/12/20/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20Transform/" title="Autodesk.Revit.DB Transform"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-20</div><div class="info-item-2">Autodesk.Revit.DB Transform</div></div><div class="info-2"><div class="info-item-1">Autodesk.Revit.DB Transform仿射三维空间的一个变换。 语法public class Transform : APIObject示例12345678910111213141516171819202122### public static XYZ TransformPoint(XYZ point, Transform transform)&#123;    double x = point.X;    double y = point.Y;    double z = point.Z;    //transform basis of the old coordinate system in the new coordinate // system    XYZ b0 = transform.get_Basis(0);    XYZ b1 = transform.get_Basis(1);    XYZ b2 = transform.get_Basis(2);    XYZ origin = transform.Origin;       ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/4stars.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">funtim41@gmail.com</div><div class="author-info-description">实践-认识-再实践-再认识</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/FunTim41"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/FunTim41" target="_blank" title="Github"><i class="fab fa-github" style="color: #FFFFFF;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA"><span class="toc-number">1.</span> <span class="toc-text">导出</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E8%A1%A8"><span class="toc-number">1.1.</span> <span class="toc-text">导出表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IFC%E5%AF%BC%E5%87%BA"><span class="toc-number">1.2.</span> <span class="toc-text">IFC导出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA"><span class="toc-number">1.3.</span> <span class="toc-text">自定义导出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%EF%BC%9A%E7%BF%BB%E8%AF%91%E8%87%AARevit-API-Developers-Guide"><span class="toc-number">1.4.</span> <span class="toc-text">注：翻译自Revit API Developers Guide</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/08/%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE/Hexo+Butterfly%E4%BB%A3%E7%A0%81%E5%9D%97%E6%B0%B4%E5%B9%B3%E6%BB%9A%E5%8A%A8%E6%9D%A1/" title="Hexo+Butterfly代码块水平滚动条">Hexo+Butterfly代码块水平滚动条</a><time datetime="2025-01-08T04:24:42.742Z" title="更新于 2025-01-08 12:24:42">2025-01-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/18/RevitApi%E5%90%88%E9%9B%86/Autodesk.RevitAddIns%20Namespace/" title="Autodesk.RevitAddIns Namespace">Autodesk.RevitAddIns Namespace</a><time datetime="2025-01-05T09:13:27.547Z" title="更新于 2025-01-05 17:13:27">2025-01-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/18/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20CurveArray/" title="Autodesk.Revit.DB CurveArray">Autodesk.Revit.DB CurveArray</a><time datetime="2025-01-04T02:50:53.238Z" title="更新于 2025-01-04 10:50:53">2025-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/10/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20Opening/" title="Autodesk.Revit.DB Opening">Autodesk.Revit.DB Opening</a><time datetime="2025-01-04T02:47:58.908Z" title="更新于 2025-01-04 10:47:58">2025-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/10/RevitApi%E5%90%88%E9%9B%86/Autodesk.Revit.DB%20ReferenceIntersector/" title="Autodesk.Revit.DB ReferenceIntersector">Autodesk.Revit.DB ReferenceIntersector</a><time datetime="2025-01-04T02:47:17.298Z" title="更新于 2025-01-04 10:47:17">2025-01-04</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/images/topback.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By funtim41@gmail.com</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">学而不思则罔，思而不学则殆。</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (false){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'FunTim41/funtim41.github.io',
      'data-repo-id': 'R_kgDONjG8ww',
      'data-category-id': 'DIC_kwDONjG8w84Cllg2',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>